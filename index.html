<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Max Messenger</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #36393f;
            color: white;
            height: 100vh;
        }

        .hidden {
            display: none !important;
        }

        /* Аутентификация */
        .auth-container {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .auth-box {
            background: #36393f;
            padding: 32px;
            border-radius: 8px;
            box-shadow: 0 8px 16px rgba(0,0,0,0.24);
            width: 400px;
        }

        .auth-box h1 {
            text-align: center;
            margin-bottom: 24px;
            font-size: 24px;
        }

        .auth-tabs {
            display: flex;
            margin-bottom: 24px;
            border-bottom: 1px solid #40444b;
        }

        .auth-tab {
            background: none;
            border: none;
            color: #b9bbbe;
            padding: 12px 24px;
            cursor: pointer;
            border-bottom: 2px solid transparent;
            font-size: 14px;
        }

        .auth-tab:hover {
            background: #2f3136;
            color: white;
        }

        .auth-tab.active {
            color: white;
            border-bottom-color: #5865f2;
            background: #2f3136;
        }

        .auth-form {
            display: none;
        }

        .auth-form.active {
            display: block;
        }

        .auth-form input {
            width: 100%;
            padding: 12px 16px;
            margin-bottom: 16px;
            background: #2f3136;
            border: 1px solid #40444b;
            border-radius: 4px;
            color: white;
            font-size: 14px;
        }

        .auth-form input:focus {
            outline: none;
            border-color: #5865f2;
        }

        .auth-form button {
            width: 100%;
            padding: 12px 16px;
            background: #5865f2;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
        }

        .auth-form button:hover {
            background: #4752c4;
        }

        /* Основное приложение */
        .app-container {
            display: flex;
            height: 100vh;
            background: #36393f;
        }
    </style>
</head>
<body>
    <!-- Страница аутентификации -->
    <div id="auth-page" class="auth-container">
        <div class="auth-box">
            <h1>Max Messenger</h1>
            <div class="auth-tabs">
                <button class="auth-tab active" onclick="switchTab('login')">Вход</button>
                <button class="auth-tab" onclick="switchTab('register')">Регистрация</button>
            </div>
            
            <form id="login-form" class="auth-form active" onsubmit="login(event)">
                <input type="email" id="login-email" placeholder="Email" required>
                <input type="password" id="login-password" placeholder="Пароль" required>
                <button type="submit">Войти</button>
            </form>
            
            <form id="register-form" class="auth-form" onsubmit="register(event)">
                <input type="text" id="register-username" placeholder="Имя пользователя" required>
                <input type="email" id="register-email" placeholder="Email" required>
                <input type="password" id="register-password" placeholder="Пароль" required>
                <button type="submit">Зарегистрироваться</button>
            </form>
        </div>
    </div>

    <!-- Основное приложение -->
    <div id="app" class="app-container hidden">
        <div style="padding: 20px;">
            <h2>Добро пожаловать в мессенджер!</h2>
            <button onclick="logout()" style="padding: 10px 20px; background: #ed4245; color: white; border: none; border-radius: 4px; cursor: pointer; margin-top: 20px;">
                Выйти
            </button>
        </div>
    </div>

    <script>
        // Простые функции для работы мессенджера
        function switchTab(tabName) {
            console.log('Переключаем на вкладку:', tabName);
            
            // Убираем активные классы
            document.querySelectorAll('.auth-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.auth-form').forEach(form => {
                form.classList.remove('active');
            });
            
            // Добавляем активные классы
            document.querySelector(`.auth-tab[onclick="switchTab('${tabName}')"]`).classList.add('active');
            document.getElementById(tabName + '-form').classList.add('active');
        }

        function register(event) {
            event.preventDefault();
            console.log('Регистрация начата!');
            
            const username = document.getElementById('register-username').value;
            const email = document.getElementById('register-email').value;
            const password = document.getElementById('register-password').value;
            
            if (!username || !email || !password) {
                alert('Заполните все поля!');
                return;
            }
            
            // Получаем существующих пользователей
            const users = JSON.parse(localStorage.getItem('users') || '[]');
            
            // Проверяем, есть ли пользователь с таким email
            if (users.find(user => user.email === email)) {
                alert('Пользователь с таким email уже существует!');
                return;
            }
            
            // Создаем нового пользователя
            const newUser = {
                id: Date.now().toString(),
                username: username,
                email: email,
                password: password,
                createdAt: new Date().toISOString()
            };
            
            // Сохраняем пользователя
            users.push(newUser);
            localStorage.setItem('users', JSON.stringify(users));
            
            alert('Регистрация успешна! Теперь вы можете войти.');
            
            // Переключаем на вкладку входа
            switchTab('login');
            
            // Очищаем форму
            document.getElementById('register-form').reset();
        }

        function login(event) {
            event.preventDefault();
            console.log('Вход начат!');
            
            const email = document.getElementById('login-email').value;
            const password = document.getElementById('login-password').value;
            
            // Получаем пользователей
            const users = JSON.parse(localStorage.getItem('users') || '[]');
            
            // Ищем пользователя
            const user = users.find(user => user.email === email && user.password === password);
            
            if (user) {
                // Сохраняем текущего пользователя
                localStorage.setItem('currentUser', JSON.stringify(user));
                
                // Показываем приложение
                document.getElementById('auth-page').classList.add('hidden');
                document.getElementById('app').classList.remove('hidden');
                
                alert('Добро пожаловать, ' + user.username + '!');
            } else {
                alert('Неверный email или пароль!');
            }
        }

        function logout() {
            localStorage.removeItem('currentUser');
            document.getElementById('auth-page').classList.remove('hidden');
            document.getElementById('app').classList.add('hidden');
            alert('Вы вышли из аккаунта');
        }

        // Проверяем авторизацию при загрузке
        window.addEventListener('load', function() {
            const currentUser = localStorage.getItem('currentUser');
            if (currentUser) {
                document.getElementById('auth-page').classList.add('hidden');
                document.getElementById('app').classList.remove('hidden');
            }
            
            // Создаем демо пользователя если нет пользователей
            if (!localStorage.getItem('users')) {
                const demoUsers = [
                    {
                        id: '1',
                        username: 'DemoUser',
                        email: 'demo@example.com',
                        password: '123456',
                        createdAt: new Date().toISOString()
                    }
                ];
                localStorage.setItem('users', JSON.stringify(demoUsers));
                console.log('Создан демо пользователь: demo@example.com / 123456');
            }
        });
    </script>
</body>
</html>
